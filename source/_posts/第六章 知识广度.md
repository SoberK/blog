---
title: 提升 - 知识广度
date: 2022-08-13 10:24:31
category: 提升
tag: js
password: 123789
abstract: 这里有东西被加密了，需要输入密码查看哦。
message: 您好，这里需要密码。
wrong_pass_message: 抱歉，这个密码看着不太对，请再试试。
wrong_hash_message: 抱歉，这个文章不能被纠正，不过您还是能看看解密后的内容。
---

#### 1、网络请求中，token 和 cookie 有什么区别

- cookie

  - HTTP 无状态，每次请求都要带 token，已帮助识别身份

  - 服务端也可以像客户端 set-cookie,cookie 大小限制 4kb

  - 默认有跨域限制：不可以跨域共享、传递 cookie
  - html5 之前长被用于存储
  - 现代浏览器开始禁止第三方 cookie

- session

![image-20220710153630513](/Users/fanrongkong/Library/Application Support/typora-user-images/image-20220710153630513.png)

- token
  - cookie 是 Http 规范，二 token 是自定义传递
  - cookie 会默认被浏览器存储，而 token 徐自己存储
  - token 默认没有跨域限制
- 答案
  - cookieHttp 标准，跨域限制，配合 session 使用
  - token 无标准，无跨域限制，使用 JWT

#### 2、session 和 jwt 那个更好

- session
  - 优点
    - 易于学习
    - 用户信息存储再服务端的，可快速封禁某个用户
  - 缺点
    - 占用服务内存，硬件成本过高
    - 多进程，多服务器时，不好同步-需使用第三方缓存，如 redis
    - 默认有跨域限制
- jwt
  - 优点
    - 不占用服务端内存
    - 多进程，多服务器不收影响
  - 缺点
    - 用户信息存储在客户端，无法快速封禁某某用户
    - 万一服务端密钥被泄漏，贼用户信息全部丢失
    - token 体积一般会大于 cookie，会增加请求的数据量
- 答案：
  - 如果又严格管理用户信息的需求，推荐 session
  - 如果没有特殊要求，则使用 jwt

#### 3、移动端 H5 click 事件的 300ms 延迟

- 起因：满足 double tap to zoom

- fastClick 原理
  - 监听 touchEnd 事件 ，touchStart touchEnd 优于 ckick 触发
  - 使用自定义 dom 事件，模拟一个 click 事件
  - 把默认的 click 事件禁止掉
- 现在浏览器的优化，只要浏览器有 width=device-width 后就不会存在这个问题

#### 4、UDP 协和和 Http 协议

- http 在应用层
- tcp、udp 是在传输层
- tcp 的特点
  - 3 次握手
  - 4 次挥手
  - 稳定传输
- udp 的特点
  - 无连接
  - 无断开
  - 不稳定传输，但传输效率高
  - 如视屏会议，语音通话

#### 5、Http 协议 1.0 和 1.1、2.0 的区别

- 1.0
  - 最基础的 http 协议
  - 只支持 get、和 post
- 1.1
  - 缓存策略
  - 支持长连接，一次 tcp 请求链接多次请求
  - 断点续传、状态 206
  - 支持 put delete 等
- 2.0
  - 压缩 header ，减少体积
  - 多路复用，一次 tcp 链接可以多个 http 并行请求

#### 6、什么事 Https 中间人攻击？如何预防

- http 是明文传输
- https 流程

![image-20220710212125392](/Users/fanrongkong/Library/Application Support/typora-user-images/image-20220710212125392.png)

#### 7、script 的 defer 和 async 有什么区别

- 正常
  - 先渲染，遇到了 js，先加载在运行，最后在接着渲染
    - js 放在头部：第一种情况就是刚刚说的，先渲染后加载执行，最后接着渲染
    - js 放在尾部，直接渲染完毕后在加载执行
- defer 延迟
  - 渲染和加载 js 同步执行，最后在执行 js
- async 异步
  - 渲染和加载 js 同步执行，再阻断渲染，执行 js，最后恢复渲染
- 绿色是渲染，蓝色是加载，红色是执行
- ![image-20220711104033398](/Users/fanrongkong/Library/Application Support/typora-user-images/image-20220711104033398.png)

#### 8、preload 和 prefetch

- 链接的是不同的地址只是方式不一样

- Preload 资源在当前页面使用，会优先加载

- prefetch 资源在未来页面使用，会空闲事现在

  ```
  <link rel="preload" href.... />
  <link rel="prefetch" href.... />
  ```

#### 9、dns-prefetch 和 preconnect

- 链接的是同一个地址

- dns-prefetch 预查询
- Preconnect 预链接

```
<link rel="dns-prefetch" href="http://fonts.com" />
<link rel="preconnect" href="http://fonts.com" />
```

#### 10、你知道那些前端攻击？该如何预防？

- XSS
  - Cross site script 跨站脚本攻击
  - 手段：黑客蒋 js 代码插入到网页页面中，渲染事执行 js 代码
  - 预防：特殊字符替换
- Csrf
  - Cross site request Forgery 跨域请求伪造
  - 手段：黑客诱导用户去访问另一个网站的接口，伪造请求
  - 预防：严格控制跨域+验证码机制
- 点击劫持
  - click jacking
  - 手段：诱导界面上蒙一个透明的 ifream，诱导用户点击
  - 预防：严格控制跨域
- DDos
  - Distribute denial-of-seervice 分布式拒绝服务
  - 手段：分布式的、大规模的流量访问，是服务器瘫痪
  - 预防：软件层面不能做，需要硬件防御（如阿里的 WAF）
- SQL 注入
  - 手段：黑客提交 SQl 语句，破坏数据库
  - 预防：处理输入内容，替换特殊字符

#### 11、描述从输入 Url 到页面展示的完整过程

- 网络请求
  - DNS 查询，建立 TCP 链接
  - 浏览器发送 Http 请求
  - 收到请求响应，得到 HTML 源码
- 解析
  - Html 构建 dom 树
  - css 构建 cssom 数
  - 两者结合，行程 render tree
- 渲染
  - 计算 dom 尺寸，定位，最后渲染到页面‘
  - 遇到 js 可能会执行
  - 异步 css，图片可能重复渲染
- 答案：
  - 网路请求：dns 解析，http 请求
  - 解析：dom 树，cssom 树，rendertree 生成
  - 渲染：计算绘制，同事执行 js

#### 12、重绘、和重排

- 重绘 repaint
  - 元素外观改变，如颜色、背景色
  - 但元素的尺寸、定位不变、不会影响到其他元素的位置
- 重排 reflow
  - 重新计算尺寸和布局，可能会影响其他元素的位置
  - 如元素的高度增加，可能会使相邻的元素位置下移
- 区别：重排比重绘更消耗资源
- 减少重排的方法
  - 集中修改样式，或直接切换 css class
  - 修改之前先设置 display:none,脱离文档流
  - 使用 BFC 特性，不影响其他元素位置
  - 频繁出发使用防抖节流
  - 使用 createDocumentFragment 批量操作 dom
  - 优化动画，使用 css 和 requestAnimationFrame

#### 13、BFC

- 块级格式化上下文
- 内部元素无论如何改动，都不会影响其他元素的位置
- 触发条件
  - 根节点<html>
  - Float: left/right
  - Overflow:auto/scroll/hidden
  - Display:inline-block/flex/table/table-cell
  - Position:absolute;fixed

#### 14、如何实现网页多标签通讯？（a 页面列表点到 b 详情中，b 页面修改值后通知 a 页面去修改状态，而不是刷新页面）

- 使用 websocket

  - 需要服务端提供支持，成本高
  - 可以跨域

- 通过 localstorage 通讯

  - 同域、

    ```
    window.addEventListener('storage',function(){

    })
    ```

- 通过 sharedWord 通讯

  - sharedWorker 是 webwork 的一种
  - webWorker 可以开启子进程，但不能操作 dom
  - sharedWorker 可单独开启一个进程，用于同域页面通讯

#### 15、网页和 ifream 直接的通讯

- 使用 postMessage 通讯
- 注意跨域的限制和判断

```
window.ifream1.content.postMessage('hello','*')
window.addEventListener('message',function(event){
	console.log(event.origin) //来源
		console.log(event.data) //数据
})
```
